value_sets:
  go:
    package: stages
templates:
- template: ../cryptos/const_type.go.tpl
  out: stages.gen.go
  value_sets:
  - go
  values:
    type_name: Stage
    type_desc: stage
    consts:
    # keys and token generation
    - name: GenerateKeys
      value: generate-keys
    - name: GenerateToken
      value: generate-token

    # proposal exchange
    - name: SendProposal
      value: send-proposal
    - name: ReceiveProposal
      value: receive-proposal
    - name: SendProposalResponse
      value: send-proposal-response
    - name: ReceiveProposalResponse
      value: receive-proposal-response

    # # key data exchange and lock generation
    # SendKeyData: send-key-data
    # ReceiveKeyData: receive-key-data

    # # lock exchange
    # SendLock: send-lock
    # ReceiveLock: receive-lock

    # # lock generation and check
    # GenerateLock: generate-lock
    # CheckLock: check-lock

    # funds locking
    - name: LockFunds
      value: lock-funds
    - name: WaitLockedFunds
      value: wait-locked-funds

    # redeem and wait for funds redeem
    - name: WaitFundsRedeemed
      value: wait-funds-redeemed
    - name: RedeemFunds
      value: redeem

    # done
    - name: Done
      value: done

# ---------------------------------------------------------------------------------
#                                  manual exchange
#   buyer                              | opr |  seller
# -------------------------------------|-----|-------------------------------------
#   sends proposal to seller           | --> |  receives proposal
#   receives proposal response         | <-- |  sends proposal response to buyer
#   generate redeem and recovery keys  |  G  |  generate redeem and recovery keys
#   generates a secret token           |  G  |
#   receives sellers redeem key hash   | <-- |  sends redeem key hash to buyer
#   generates lockscript (Lb)          |  G  |
#   sends lockscript to seller         | --> |  receives lockscript and check it
#
#   sends redeem key hash to seller    | --> |  receives buyers redeem key hash
#                                      |  G  |  generates lockscript (Ls)
#   receive lockscript and check it    | <-- |  sends lockscript to buyer
#   locks funds with lockscript Lb     | L/W |  waits for buyer lock transaction(s)
#
#   waits for seller transaction(s)    | W/L |  locks funds with lockscript Ls
#   redeems funds with token           | R/W |  waits for buyer redeem transaction and extract token
#                                      |  R  |  redeems funds with token
